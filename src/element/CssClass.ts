
type CssStyleProps = Partial<CSSStyleDeclaration> & {
  'accent-color'?: string;
  'align-content'?: string;
  'align-items'?: string;
  'align-self'?: string;
  'alignment-baseline'?: string;
  'all'?: string;
  'animation'?: string;
  'animation-delay'?: string;
  'animation-direction'?: string;
  'animation-duration'?: string;
  'animation-fill-mode'?: string;
  'animation-iteration-count'?: string;
  'animation-name'?: string;
  'animation-play-state'?: string;
  'animation-timing-function'?: string;
  'appearance'?: string;
  'aspect-ratio'?: string;
  'backface-visibility'?: string;
  'background'?: string;
  'background-attachment'?: string;
  'background-blend-mode'?: string;
  'background-clip'?: string;
  'background-color'?: string;
  'background-image'?: string;
  'background-origin'?: string;
  'background-position'?: string;
  'background-position-x'?: string;
  'background-position-y'?: string;
  'background-repeat'?: string;
  'background-size'?: string;
  'baseline-shift'?: string;
  'block-size'?: string;
  'border'?: string;
  'border-block'?: string;
  'border-block-color'?: string;
  'border-block-end'?: string;
  'border-block-end-color'?: string;
  'border-block-end-style'?: string;
  'border-block-end-width'?: string;
  'border-block-start'?: string;
  'border-block-start-color'?: string;
  'border-block-start-style'?: string;
  'border-block-start-width'?: string;
  'border-block-style'?: string;
  'border-block-width'?: string;
  'border-bottom'?: string;
  'border-bottom-color'?: string;
  'border-bottom-left-radius'?: string;
  'border-bottom-right-radius'?: string;
  'border-bottom-style'?: string;
  'border-bottom-width'?: string;
  'border-collapse'?: string;
  'border-color'?: string;
  'border-end-end-radius'?: string;
  'border-end-start-radius'?: string;
  'border-image'?: string;
  'border-image-outset'?: string;
  'border-image-repeat'?: string;
  'border-image-slice'?: string;
  'border-image-source'?: string;
  'border-image-width'?: string;
  'border-inline'?: string;
  'border-inline-color'?: string;
  'border-inline-end'?: string;
  'border-inline-end-color'?: string;
  'border-inline-end-style'?: string;
  'border-inline-end-width'?: string;
  'border-inline-start'?: string;
  'border-inline-start-color'?: string;
  'border-inline-start-style'?: string;
  'border-inline-start-width'?: string;
  'border-inline-style'?: string;
  'border-inline-width'?: string;
  'border-left'?: string;
  'border-left-color'?: string;
  'border-left-style'?: string;
  'border-left-width'?: string;
  'border-radius'?: string;
  'border-right'?: string;
  'border-right-color'?: string;
  'border-right-style'?: string;
  'border-right-width'?: string;
  'border-spacing'?: string;
  'border-start-end-radius'?: string;
  'border-start-start-radius'?: string;
  'border-style'?: string;
  'border-top'?: string;
  'border-top-color'?: string;
  'border-top-left-radius'?: string;
  'border-top-right-radius'?: string;
  'border-top-style'?: string;
  'border-top-width'?: string;
  'border-width'?: string;
  'bottom'?: string;
  'box-shadow'?: string;
  'box-sizing'?: string;
  'break-after'?: string;
  'break-before'?: string;
  'break-inside'?: string;
  'caption-side'?: string;
  'caret-color'?: string;
  'clear'?: string;
  /** @deprecated */
  'clip'?: string;
  'clip-path'?: string;
  'clip-rule'?: string;
  'color'?: string;
  'color-interpolation'?: string;
  'color-interpolation-filters'?: string;
  'color-scheme'?: string;
  'column-count'?: string;
  'column-fill'?: string;
  'column-gap'?: string;
  'column-rule'?: string;
  'column-rule-color'?: string;
  'column-rule-style'?: string;
  'column-rule-width'?: string;
  'column-span'?: string;
  'column-width'?: string;
  'columns'?: string;
  'contain'?: string;
  'content'?: string;
  'counter-increment'?: string;
  'counter-reset'?: string;
  'counter-set'?: string;
  'css-float'?: string;
  'css-text'?: string;
  'cursor'?: string;
  'direction'?: string;
  'display'?: string;
  'dominant-baseline'?: string;
  'empty-cells'?: string;
  'fill'?: string;
  'fill-opacity'?: string;
  'fill-rule'?: string;
  'filter'?: string;
  'flex'?: string;
  'flex-basis'?: string;
  'flex-direction'?: string;
  'flex-flow'?: string;
  'flex-grow'?: string;
  'flex-shrink'?: string;
  'flex-wrap'?: string;
  'float'?: string;
  'flood-color'?: string;
  'flood-opacity'?: string;
  'font'?: string;
  'font-family'?: string;
  'font-feature-settings'?: string;
  'font-kerning'?: string;
  'font-optical-sizing'?: string;
  'font-size'?: string;
  'font-size-adjust'?: string;
  'font-stretch'?: string;
  'font-style'?: string;
  'font-synthesis'?: string;
  'font-variant'?: string;
  'font-variant-alternates'?: string;
  'font-variant-caps'?: string;
  'font-variant-east-asian'?: string;
  'font-variant-ligatures'?: string;
  'font-variant-numeric'?: string;
  'font-variant-position'?: string;
  'font-variation-settings'?: string;
  'font-weight'?: string;
  'gap'?: string;
  'grid'?: string;
  'grid-area'?: string;
  'grid-auto-columns'?: string;
  'grid-auto-flow'?: string;
  'grid-auto-rows'?: string;
  'grid-column'?: string;
  'grid-column-end'?: string;
  /** @deprecated This is a legacy alias of `columnGap`. */
  'grid-column-gap'?: string;
  'grid-column-start'?: string;
  /** @deprecated This is a legacy alias of `gap`. */
  'grid-gap'?: string;
  'grid-row'?: string;
  'grid-row-end'?: string;
  /** @deprecated This is a legacy alias of `rowGap`. */
  'grid-row-gap'?: string;
  'grid-row-start'?: string;
  'grid-template'?: string;
  'grid-template-areas'?: string;
  'grid-template-columns'?: string;
  'grid-template-rows'?: string;
  'height'?: string;
  'hyphens'?: string;
  /** @deprecated */
  'image-orientation'?: string;
  'image-rendering'?: string;
  'inline-size'?: string;
  'inset'?: string;
  'inset-block'?: string;
  'inset-block-end'?: string;
  'inset-block-start'?: string;
  'inset-inline'?: string;
  'inset-inline-end'?: string;
  'inset-inline-start'?: string;
  'isolation'?: string;
  'justify-content'?: string;
  'justify-items'?: string;
  'justify-self'?: string;
  'left'?: string;
  'letter-spacing'?: string;
  'lighting-color'?: string;
  'line-break'?: string;
  'line-height'?: string;
  'list-style'?: string;
  'list-style-image'?: string;
  'list-style-position'?: string;
  'list-style-type'?: string;
  'margin'?: string;
  'margin-block'?: string;
  'margin-block-end'?: string;
  'margin-block-start'?: string;
  'margin-bottom'?: string;
  'margin-inline'?: string;
  'margin-inline-end'?: string;
  'margin-inline-start'?: string;
  'margin-left'?: string;
  'margin-right'?: string;
  'margin-top'?: string;
  'marker'?: string;
  'marker-end'?: string;
  'marker-mid'?: string;
  'marker-start'?: string;
  'mask'?: string;
  'mask-clip'?: string;
  'mask-composite'?: string;
  'mask-image'?: string;
  'mask-mode'?: string;
  'mask-origin'?: string;
  'mask-position'?: string;
  'mask-repeat'?: string;
  'mask-size'?: string;
  'mask-type'?: string;
  'max-block-size'?: string;
  'max-height'?: string;
  'max-inline-size'?: string;
  'max-width'?: string;
  'min-block-size'?: string;
  'min-height'?: string;
  'min-inline-size'?: string;
  'min-width'?: string;
  'mix-blend-mode'?: string;
  'object-fit'?: string;
  'object-position'?: string;
  'offset'?: string;
  'offset-distance'?: string;
  'offset-path'?: string;
  'offset-rotate'?: string;
  'opacity'?: string;
  'order'?: string;
  'orphans'?: string;
  'outline'?: string;
  'outline-color'?: string;
  'outline-offset'?: string;
  'outline-style'?: string;
  'outline-width'?: string;
  'overflow'?: string;
  'overflow-anchor'?: string;
  'overflow-wrap'?: string;
  'overflow-x'?: string;
  'overflow-y'?: string;
  'overscroll-behavior'?: string;
  'overscroll-behavior-block'?: string;
  'overscroll-behavior-inline'?: string;
  'overscroll-behavior-x'?: string;
  'overscroll-behavior-y'?: string;
  'padding'?: string;
  'padding-block'?: string;
  'padding-block-end'?: string;
  'padding-block-start'?: string;
  'padding-bottom'?: string;
  'padding-inline'?: string;
  'padding-inline-end'?: string;
  'padding-inline-start'?: string;
  'padding-left'?: string;
  'padding-right'?: string;
  'padding-top'?: string;
  'page-break-after'?: string;
  'page-break-before'?: string;
  'page-break-inside'?: string;
  'paint-order'?: string;
  'perspective'?: string;
  'perspective-origin'?: string;
  'place-content'?: string;
  'place-items'?: string;
  'place-self'?: string;
  'pointer-events'?: string;
  'position'?: string;
  'print-color-adjust'?: string;
  'quotes'?: string;
  'resize'?: string;
  'right'?: string;
  'rotate'?: string;
  'row-gap'?: string;
  'ruby-position'?: string;
  'scale'?: string;
  'scroll-behavior'?: string;
  'scroll-margin'?: string;
  'scroll-margin-block'?: string;
  'scroll-margin-block-end'?: string;
  'scroll-margin-block-start'?: string;
  'scroll-margin-bottom'?: string;
  'scroll-margin-inline'?: string;
  'scroll-margin-inline-end'?: string;
  'scroll-margin-inline-start'?: string;
  'scroll-margin-left'?: string;
  'scroll-margin-right'?: string;
  'scroll-margin-top'?: string;
  'scroll-padding'?: string;
  'scroll-padding-block'?: string;
  'scroll-padding-block-end'?: string;
  'scroll-padding-block-start'?: string;
  'scroll-padding-bottom'?: string;
  'scroll-padding-inline'?: string;
  'scroll-padding-inline-end'?: string;
  'scroll-padding-inline-start'?: string;
  'scroll-padding-left'?: string;
  'scroll-padding-right'?: string;
  'scroll-padding-top'?: string;
  'scroll-snap-align'?: string;
  'scroll-snap-stop'?: string;
  'scroll-snap-type'?: string;
  'scrollbar-gutter'?: string;
  'shape-image-threshold'?: string;
  'shape-margin'?: string;
  'shape-outside'?: string;
  'shape-rendering'?: string;
  'stop-color'?: string;
  'stop-opacity'?: string;
  'stroke'?: string;
  'stroke-dasharray'?: string;
  'stroke-dashoffset'?: string;
  'stroke-linecap'?: string;
  'stroke-linejoin'?: string;
  'stroke-miterlimit'?: string;
  'stroke-opacity'?: string;
  'stroke-width'?: string;
  'tab-size'?: string;
  'table-layout'?: string;
  'text-align'?: string;
  'text-align-last'?: string;
  'text-anchor'?: string;
  'text-combine-upright'?: string;
  'text-decoration'?: string;
  'text-decoration-color'?: string;
  'text-decoration-line'?: string;
  'text-decoration-skip-ink'?: string;
  'text-decoration-style'?: string;
  'text-decoration-thickness'?: string;
  'text-emphasis'?: string;
  'text-emphasis-color'?: string;
  'text-emphasis-position'?: string;
  'text-emphasis-style'?: string;
  'text-indent'?: string;
  'text-orientation'?: string;
  'text-overflow'?: string;
  'text-rendering'?: string;
  'text-shadow'?: string;
  'text-transform'?: string;
  'text-underline-offset'?: string;
  'text-underline-position'?: string;
  'top'?: string;
  'touch-action'?: string;
  'transform'?: string;
  'transform-box'?: string;
  'transform-origin'?: string;
  'transform-style'?: string;
  'transition'?: string;
  'transition-delay'?: string;
  'transition-duration'?: string;
  'transition-property'?: string;
  'transition-timing-function'?: string;
  'translate'?: string;
  'unicode-bidi'?: string;
  'user-select'?: string;
  'vertical-align'?: string;
  'visibility'?: string;
  /** ?@deprecated This is a legacy alias of `alignContent`. */
  'webkit-align-content'?: string;
  /** @deprecated This is a legacy alias of `alignItems`. */
  'webkit-align-items'?: string;
  /** @deprecated This is a legacy alias of `alignSelf`. */
  'webkit-align-self'?: string;
  /** @deprecated This is a legacy alias of `animation`. */
  'webkit-animation'?: string;
  /** @deprecated This is a legacy alias of `animationDelay`. */
  'webkit-animation-delay'?: string;
  /** @deprecated This is a legacy alias of `animationDirection`. */
  'webkit-animation-direction'?: string;
  /** @deprecated This is a legacy alias of `animationDuration`. */
  'webkit-animation-duration'?: string;
  /** @deprecated This is a legacy alias of `animationFillMode`. */
  'webkit-animation-fill-mode'?: string;
  /** @deprecated This is a legacy alias of `animationIterationCount`. */
  'webkit-animation-iteration-count'?: string;
  /** @deprecated This is a legacy alias of `animationName`. */
  'webkit-animation-name'?: string;
  /** @deprecated This is a legacy alias of `animationPlayState`. */
  'webkit-animation-play-state'?: string;
  /** @deprecated This is a legacy alias of `animationTimingFunction`. */
  'webkit-animation-timing-function'?: string;
  /** @deprecated This is a legacy alias of `appearance`. */
  'webkit-appearance'?: string;
  /** @deprecated This is a legacy alias of `backfaceVisibility`. */
  'webkit-backface-visibility'?: string;
  /** @deprecated This is a legacy alias of `backgroundClip`. */
  'webkit-background-clip'?: string;
  /** @deprecated This is a legacy alias of `backgroundOrigin`. */
  'webkit-background-origin'?: string;
  /** @deprecated This is a legacy alias of `backgroundSize`. */
  'webkit-background-size'?: string;
  /** @deprecated This is a legacy alias of `borderBottomLeftRadius`. */
  'webkit-border-bottom-left-radius'?: string;
  /** @deprecated This is a legacy alias of `borderBottomRightRadius`. */
  'webkit-border-bottom-right-radius'?: string;
  /** @deprecated This is a legacy alias of `borderRadius`. */
  'webkit-border-radius'?: string;
  /** @deprecated This is a legacy alias of `borderTopLeftRadius`. */
  'webkit-border-top-left-radius'?: string;
  /** @deprecated This is a legacy alias of `borderTopRightRadius`. */
  'webkit-border-top-right-radius'?: string;
  /** @deprecated This is a legacy alias of `boxAlign`. */
  'webkit-box-align'?: string;
  /** @deprecated This is a legacy alias of `boxFlex`. */
  'webkit-box-flex'?: string;
  /** @deprecated This is a legacy alias of `boxOrdinalGroup`. */
  'webkit-box-ordinal-group'?: string;
  /** @deprecated This is a legacy alias of `boxOrient`. */
  'webkit-box-orient'?: string;
  /** @deprecated This is a legacy alias of `boxPack`. */
  'webkit-box-pack'?: string;
  /** @deprecated This is a legacy alias of `boxShadow`. */
  'webkit-box-shadow'?: string;
  /** @deprecated This is a legacy alias of `boxSizing`. */
  'webkit-box-sizing'?: string;
  /** @deprecated This is a legacy alias of `filter`. */
  'webkit-filter'?: string;
  /** @deprecated This is a legacy alias of `flex`. */
  'webkit-flex'?: string;
  /** @deprecated This is a legacy alias of `flexBasis`. */
  'webkit-flex-basis'?: string;
  /** @deprecated This is a legacy alias of `flexDirection`. */
  'webkit-flex-direction'?: string;
  /** @deprecated This is a legacy alias of `flexFlow`. */
  'webkit-flex-flow'?: string;
  /** @deprecated This is a legacy alias of `flexGrow`. */
  'webkit-flex-grow'?: string;
  /** @deprecated This is a legacy alias of `flexShrink`. */
  'webkit-flex-shrink'?: string;
  /** @deprecated This is a legacy alias of `flexWrap`. */
  'webkit-flex-wrap'?: string;
  /** @deprecated This is a legacy alias of `justifyContent`. */
  'webkit-justify-content'?: string;
  'webkit-line-clamp'?: string;
  /** @deprecated This is a legacy alias of `mask`. */
  'webkit-mask'?: string;
  /** @deprecated This is a legacy alias of `maskBorder`. */
  'webkit-mask-box-image'?: string;
  /** @deprecated This is a legacy alias of `maskBorderOutset`. */
  'webkit-mask-box-image-outset'?: string;
  /** @deprecated This is a legacy alias of `maskBorderRepeat`. */
  'webkit-mask-box-image-repeat'?: string;
  /** @deprecated This is a legacy alias of `maskBorderSlice`. */
  'webkit-mask-box-image-slice'?: string;
  /** @deprecated This is a legacy alias of `maskBorderSource`. */
  'webkit-mask-box-image-source'?: string;
  /** @deprecated This is a legacy alias of `maskBorderWidth`. */
  'webkit-mask-box-image-width'?: string;
  /** @deprecated This is a legacy alias of `maskClip`. */
  'webkit-mask-clip'?: string;
  'webkit-mask-composite'?: string;
  /** @deprecated This is a legacy alias of `maskImage`. */
  'webkit-mask-image'?: string;
  /** @deprecated This is a legacy alias of `maskOrigin`. */
  'webkit-mask-origin'?: string;
  /** @deprecated This is a legacy alias of `maskPosition`. */
  'webkit-mask-position'?: string;
  /** @deprecated This is a legacy alias of `maskRepeat`. */
  'webkit-mask-repeat'?: string;
  /** @deprecated This is a legacy alias of `maskSize`. */
  'webkit-mask-size'?: string;
  /** @deprecated This is a legacy alias of `order`. */
  'webkit-order'?: string;
  /** @deprecated This is a legacy alias of `perspective`. */
  'webkit-perspective'?: string;
  /** @deprecated This is a legacy alias of `perspectiveOrigin`. */
  'webkit-perspective-origin'?: string;
  'webkit-text-fill-color'?: string;
  /** @deprecated This is a legacy alias of `textSizeAdjust`. */
  'webkit-text-size-adjust'?: string;
  'webkit-text-stroke'?: string;
  'webkit-text-stroke-color'?: string;
  'webkit-text-stroke-width'?: string;
  /** @deprecated This is a legacy alias of `transform`. */
  'webkit-transform'?: string;
  /** @deprecated This is a legacy alias of `transformOrigin`. */
  'webkit-transform-origin'?: string;
  /** @deprecated This is a legacy alias of `transformStyle`. */
  'webkit-transform-style'?: string;
  /** @deprecated This is a legacy alias of `transition`. */
  'webkit-transition'?: string;
  /** @deprecated This is a legacy alias of `transitionDelay`. */
  'webkit-transition-delay'?: string;
  /** @deprecated This is a legacy alias of `transitionDuration`. */
  'webkit-transition-duration'?: string;
  /** @deprecated This is a legacy alias of `transitionProperty`. */
  'webkit-transition-property'?: string;
  /** @deprecated This is a legacy alias of `transitionTimingFunction`. */
  'webkit-transition-timing-function'?: string;
  /** @deprecated This is a legacy alias of `userSelect`. */
  'webkit-user-select'?: string;
  'white-space'?: string;
  'widows'?: string;
  'width'?: string;
  'will-change'?: string;
  'word-break'?: string;
  'word-spacing'?: string;
  /** @deprecated */
  'word-wrap'?: string;
  'writing-mode'?: string;
  'z-index'?: string;

} & {
  [key: `&:${string}`]: string | any;
};

export type CssNode = {
  [K in keyof CssStyleProps]: string | CssNode;
};
// type TEST = CssNode['color'];
export default class CssClass {

  constructor(private readonly _name: string, private readonly _obj: CssNode) {}

  getName() {
    return this._name;
  }

  getBody() {
    let css = '';
    let subclasses: CssClass[] = [];
    let media: Array<{ condition: string; el: CssClass }> = [];
    const obj = this._obj;
    Object.keys(obj).forEach(k => {
      const value = obj[k];
      if (k.startsWith('&') && typeof value !== 'string') {
        subclasses.push(
          new CssClass(this.getName() + k.replace(/^&/, ''), value)
        );
      } else if (k.startsWith('@') && typeof value !== 'string') {
        media.push({
          condition: k,
          el: new CssClass(this.getName(), value),
        });
      } else {
        css += `${kebabize(k)}:${value};`;
      }
    });
    return '.' + this.getName() + '{' + css + '}' + subclasses.map(el => el.getBody()).join('') + buildMediaRules(media);
  }

};


function kebabize(str: string) {
  return str.replace(/[A-Z]+(?![a-z])|[A-Z]/g, ($, ofs) => (ofs ? '-' : '') + $.toLowerCase());
}

// build rules for @media
function buildMediaRules(media) {
  return media.map(({ condition, el }) => {
    return `${condition}{${el.getBody()}}`;
  }).join('');
}

// import mediaRange from './mediaRange';
// const CssClass = module.exports;
// const cl = new CssClass('article', {
//   'color': 'red',
//   backgroundColor: 'yellow',
//   'margin-top': '10px',
//   '&:hover': {
//     'background-color': 'orange'
//   },
//   '&:focus': {
//     'background-color': 'orange'
//   },
  // [`@media screen and ${mediaRange('300px <= width <= 750px')}`]: {
  // [`@media screen and ${mediaRange('300px <= width')}`]: {
  // [`@media screen and ${mediaRange('width >= 300px')}`]: {
  //   'font-size': '120px',
  //   '&:focus': {
  //     'background-color': 'green'
  //   },
  // },
// });

// console.log(cl.getBody());

// '@media screen and (' + key + '){' +
//   css_for_size +
//   '}';


// const CssClass = module.exports;
// const cl = new CssClass('article', {
//   'color': 'red',
//   "margin-top": '123',
//   '&:hover': {
//     'background-color': 'orange',
//   },
//   '&:focus': {
//     'background-color': 'orange'
//   }
// });

// console.log(cl.getBody());
